{% extends 'game/base.html.twig' %}

{% block title %}Étape {{ step }}{% endblock %}

{% block body %}
    <header>
        <div>
            <h1>Étape {{ step }}</h1>
           {#  <p class="hint">Équipe {{ team_code }} • Étape en cours : {{ current_step }}</p> #}
        </div>
        <span class="badge">{{ team_code }}</span>
    </header>

    <div class="card stack"
         data-controller="game"
         data-game-endpoint-value="{{ path('game_validate') }}">
        <div class="status">Suivez les instructions de l'animateur pour cette étape.</div>
        <p class="hint">Lorsque vous avez trouvé la lettre, validez pour passer à l'étape suivante.</p>

        {% if error %}
            <div class="status closed" data-game-status-target>{{ error }}</div>
        {% endif %}

        {% if step == 'E' %}
            <div class="status">
                Pour trouver la dernière lettre suivez maintenant la piste des QR code. Commencez par scanner le premier
                qui est sur votre table, et suivez ainsi la piste jusqu'au dernier QR code qui vous révèlera la lettre à
                inscrire ci dessous. Note : suivez les QR code dans l'ordre, et uniquement ceux qui porte le code :
                "{{ team_code }}".
            </div>
        {% endif %}

        <form method="post" class="form_step" data-game-target="form" data-action="submit->game#validate" data-turbo="false">
            <input type="hidden" value="{{ step }}" data-game-target="step">
            <label>
               {#  <span class="hint">Lettre attendue</span> #}
                <input class="input" type="text" placeholder="Lettre attendue..." name="letter" maxlength="1" required data-game-target="input">
            </label>
            <button class="btn" type="submit">Valider l'étape {{ step }}</button>
        </form>
        {% if not error %}
            <div class="status closed" data-game-status-target></div>
        {% endif %}
    </div>

    <div class="card">
        <h2>Progression</h2>
        <div class="progress">
            {% for label, data in progress %}
                <span class="{% if data.completed %}completed{% endif %}">
                {{ label }}{% if data.completed %} ✓{% endif %}
            </span>
            {% endfor %}
        </div>
    </div>

{% endblock %}